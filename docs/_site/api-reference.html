<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/Faxbot/assets/css/just-the-docs-default.css"> <link rel="stylesheet" href="/Faxbot/assets/css/just-the-docs-head-nav.css" id="jtd-head-nav-stylesheet"> <style id="jtd-nav-activation"> .site-nav > ul.nav-list:first-child > li:not(:nth-child(3)) > a, .site-nav > ul.nav-list:first-child > li > ul > li a { background-image: none; } .site-nav > ul.nav-list:not(:first-child) a, .site-nav li.external a { background-image: none; } .site-nav > ul.nav-list:first-child > li:nth-child(3) > a { font-weight: 600; text-decoration: none; }.site-nav > ul.nav-list:first-child > li:nth-child(3) > button svg { transform: rotate(-90deg); }.site-nav > ul.nav-list:first-child > li.nav-list-item:nth-child(3) > ul.nav-list { display: block; } </style> <script src="/Faxbot/assets/js/vendor/lunr.min.js"></script> <script src="/Faxbot/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>API Reference | Faxbot</title> <meta name="generator" content="Jekyll v4.3.4" /> <meta property="og:title" content="API Reference" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="The first open-source, self-hostable fax API with AI integration" /> <meta property="og:description" content="The first open-source, self-hostable fax API with AI integration" /> <link rel="canonical" href="http://localhost:4000/Faxbot/api-reference.html" /> <meta property="og:url" content="http://localhost:4000/Faxbot/api-reference.html" /> <meta property="og:site_name" content="Faxbot" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="API Reference" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"The first open-source, self-hostable fax API with AI integration","headline":"API Reference","url":"http://localhost:4000/Faxbot/api-reference.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/Faxbot/" class="site-title lh-tight"> Faxbot </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </button> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/Faxbot/" class="nav-list-link">Faxbot</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in AI Integration category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Faxbot/ai-integration/" class="nav-list-link">AI Integration</a><ul class="nav-list"><li class="nav-list-item"><a href="/Faxbot/ai-integration/mcp-integration.html" class="nav-list-link">MCP Integration</a></li></ul></li><li class="nav-list-item"><a href="/Faxbot/api-reference.html" class="nav-list-link">API Reference</a></li><li class="nav-list-item"><a href="/Faxbot/SDKS.html" class="nav-list-link">SDKs (Node & Python)</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Backends category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Faxbot/backends/" class="nav-list-link">Backends</a><ul class="nav-list"><li class="nav-list-item"><a href="/Faxbot/backends/phaxio-setup.html" class="nav-list-link">Phaxio Setup (Cloud)</a></li><li class="nav-list-item"><a href="/Faxbot/backends/sinch-setup.html" class="nav-list-link">Sinch Setup (Cloud Fax v3)</a></li><li class="nav-list-item"><a href="/Faxbot/backends/sip-setup.html" class="nav-list-link">SIP/Asterisk Setup (Self-hosted)</a></li></ul></li><li class="nav-list-item"><a href="/Faxbot/IMAGES_AND_PDFS.html" class="nav-list-link">Images and PDFs (Conversion)</a></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Security category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Faxbot/security/" class="nav-list-link">Security</a><ul class="nav-list"><li class="nav-list-item"><a href="/Faxbot/security/oauth-setup.html" class="nav-list-link">OAuth / OIDC Setup (MCP SSE)</a></li></ul></li><li class="nav-list-item"><button class="nav-list-expander btn-reset" aria-label="toggle items in Scripts and Tests category" aria-pressed="false"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/Faxbot/scripts-and-tests/" class="nav-list-link">Scripts and Tests</a><ul class="nav-list"><li class="nav-list-item"><a href="/Faxbot/scripts-and-tests.html" class="nav-list-link">Scripts and Tests (Guide)</a></li><li class="nav-list-item"><a href="/Faxbot/scripts-and-tests/phaxio-e2e-test.html" class="nav-list-link">Phaxio End-to-End Test</a></li></ul></li><li class="nav-list-item"><a href="/Faxbot/TROUBLESHOOTING.html" class="nav-list-link">Troubleshooting</a></li></ul> <ul class="nav-list"><li class="nav-list-item external"> <a href="https://github.com/dmontgomery40/Faxbot" class="nav-list-link external" > GitHub Repository <svg viewBox="0 0 24 24" aria-labelledby="svg-external-link-title"><use xlink:href="#svg-external-link"></use></svg> </a> </li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/just-the-docs/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Faxbot" aria-label="Search Faxbot" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div class="main-content-wrap"> <div id="main-content" class="main-content"> <main> <h1 id="api-reference"> <a href="#api-reference" class="anchor-heading" aria-labelledby="api-reference"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> API Reference </h1> <h2 id="base-url"> <a href="#base-url" class="anchor-heading" aria-labelledby="base-url"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Base URL </h2> <ul> <li>Default: <code class="language-plaintext highlighter-rouge">http://localhost:8080</code></li> <li>Health: <code class="language-plaintext highlighter-rouge">GET /health</code> → <code class="language-plaintext highlighter-rouge">{ "status": "ok" }</code></li> <li>Readiness: <code class="language-plaintext highlighter-rouge">GET /health/ready</code> → 200 when ready; 503 otherwise</li> </ul> <h2 id="authentication-and-api-keys"> <a href="#authentication-and-api-keys" class="anchor-heading" aria-labelledby="authentication-and-api-keys"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Authentication and API Keys </h2> <ul> <li>Send <code class="language-plaintext highlighter-rouge">X-API-Key: &lt;token&gt;</code> on every request. Two options exist: <ul> <li>DB‑backed tokens (recommended): format <code class="language-plaintext highlighter-rouge">fbk_live_&lt;keyId&gt;_&lt;secret&gt;</code>, minted via admin endpoints.</li> <li>Env bootstrap key (legacy): the literal <code class="language-plaintext highlighter-rouge">API_KEY</code> value configured on the server. Use this only to bootstrap and mint DB keys.</li> </ul> </li> <li>Set <code class="language-plaintext highlighter-rouge">REQUIRE_API_KEY=true</code> in production/HIPAA to enforce authentication even if <code class="language-plaintext highlighter-rouge">API_KEY</code> is blank.</li> </ul> <p>How to get an API key (recommended flow) 1) Set a temporary bootstrap admin key in the server environment: <code class="language-plaintext highlighter-rouge">API_KEY=bootstrap_admin_only</code> (or any strong value). 2) Create a DB-backed key via admin endpoint (requires admin auth with the bootstrap env key):</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -s -X POST http://localhost:8080/admin/api-keys \
  -H "X-API-Key: $API_KEY" \
  -H 'Content-Type: application/json' \
  -d '{"name":"dev","owner":"you@example.com","scopes":["fax:send","fax:read"]}'
</code></pre></div></div> <p>3) Save the returned <code class="language-plaintext highlighter-rouge">token</code> (<code class="language-plaintext highlighter-rouge">fbk_live_&lt;keyId&gt;_&lt;secret&gt;</code>) securely — it is shown ONCE. 4) Use that token as <code class="language-plaintext highlighter-rouge">X-API-Key</code> for all client calls. You can delete the bootstrap <code class="language-plaintext highlighter-rouge">API_KEY</code> later if you wish.</p> <p>Scopes</p> <ul> <li>Enforced when authentication is required: <ul> <li><code class="language-plaintext highlighter-rouge">POST /fax</code> → scope <code class="language-plaintext highlighter-rouge">fax:send</code></li> <li><code class="language-plaintext highlighter-rouge">GET /fax/{id}</code> → scope <code class="language-plaintext highlighter-rouge">fax:read</code></li> <li>Inbound list/get/download → scopes <code class="language-plaintext highlighter-rouge">inbound:list</code> / <code class="language-plaintext highlighter-rouge">inbound:read</code></li> <li>Admin endpoints → <code class="language-plaintext highlighter-rouge">keys:manage</code> (or the bootstrap env key)</li> </ul> </li> <li>If <code class="language-plaintext highlighter-rouge">REQUIRE_API_KEY=false</code> and no <code class="language-plaintext highlighter-rouge">API_KEY</code> is set, unauthenticated requests are allowed in development; scopes are then not required.</li> </ul> <p>Token lifecycle (rotate, revoke, expire)</p> <ul> <li>Rotate: <code class="language-plaintext highlighter-rouge">POST /admin/api-keys/{keyId}/rotate</code> returns a new plaintext token once; the old secret stops working immediately.</li> <li>Revoke: <code class="language-plaintext highlighter-rouge">DELETE /admin/api-keys/{keyId}</code> sets <code class="language-plaintext highlighter-rouge">revoked_at</code> — the token is rejected thereafter.</li> <li>Expire: create keys with <code class="language-plaintext highlighter-rouge">expires_at</code> (ISO8601) to enforce automatic expiry.</li> <li>Metadata: <code class="language-plaintext highlighter-rouge">GET /admin/api-keys</code> lists non‑secret fields (<code class="language-plaintext highlighter-rouge">created_at</code>, <code class="language-plaintext highlighter-rouge">last_used_at</code>, <code class="language-plaintext highlighter-rouge">expires_at</code>, <code class="language-plaintext highlighter-rouge">revoked_at</code>, <code class="language-plaintext highlighter-rouge">scopes</code>, <code class="language-plaintext highlighter-rouge">owner</code>, <code class="language-plaintext highlighter-rouge">name</code>).</li> </ul> <p>Error semantics</p> <ul> <li>401 Unauthorized: missing/invalid token, revoked/expired token, or no admin auth for admin endpoints.</li> <li>403 Forbidden: valid token but insufficient scopes for the endpoint.</li> <li>429 Too Many Requests: per‑key rate limit exceeded.</li> </ul> <h3 id="rate-limiting-optional"> <a href="#rate-limiting-optional" class="anchor-heading" aria-labelledby="rate-limiting-optional"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Rate limiting (optional) </h3> <ul> <li>Global: <code class="language-plaintext highlighter-rouge">MAX_REQUESTS_PER_MINUTE</code> (default 0 = disabled). When enabled, each API key is limited per-minute across requests.</li> <li>Inbound-specific: <code class="language-plaintext highlighter-rouge">INBOUND_LIST_RPM</code> and <code class="language-plaintext highlighter-rouge">INBOUND_GET_RPM</code> apply to <code class="language-plaintext highlighter-rouge">GET /inbound</code>, <code class="language-plaintext highlighter-rouge">GET /inbound/{id}</code>, and <code class="language-plaintext highlighter-rouge">GET /inbound/{id}/pdf</code> (API-key path). Token-based downloads are not rate-limited.</li> <li>Exceeding the limit returns <code class="language-plaintext highlighter-rouge">429 Too Many Requests</code> with a <code class="language-plaintext highlighter-rouge">Retry-After</code> header.</li> </ul> <h2 id="endpoints"> <a href="#endpoints" class="anchor-heading" aria-labelledby="endpoints"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Endpoints </h2> <p>1) POST <code class="language-plaintext highlighter-rouge">/fax</code></p> <ul> <li>Multipart form <ul> <li><code class="language-plaintext highlighter-rouge">to</code>: destination number (E.164 or digits)</li> <li><code class="language-plaintext highlighter-rouge">file</code>: PDF or TXT</li> </ul> </li> <li>Implementation details <ul> <li>Streaming upload: file data streams to disk in chunks; the 10 MB limit is enforced incrementally to avoid memory spikes.</li> <li>Magic sniff: server validates content by signature — PDFs must begin with <code class="language-plaintext highlighter-rouge">%PDF</code>; TXT must be UTF‑8 decodable. Declared <code class="language-plaintext highlighter-rouge">content-type</code> is not trusted.</li> </ul> </li> <li>Responses <ul> <li>202 Accepted: <code class="language-plaintext highlighter-rouge">{ id, to, status, error?, pages?, backend, provider_sid?, created_at, updated_at }</code></li> <li>400 bad number; 413 file too large; 415 unsupported type; 401 invalid API key; 403 missing <code class="language-plaintext highlighter-rouge">fax:send</code> scope</li> </ul> </li> <li>Example <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -X POST http://localhost:8080/fax \
-H "X-API-Key: $API_KEY" \
-F to=+15551234567 \
-F file=@./example.pdf
</code></pre></div> </div> </li> </ul> <p>2) GET <code class="language-plaintext highlighter-rouge">/fax/{id}</code></p> <ul> <li>Returns job status as above.</li> <li>404 if not found; 401 if invalid API key; 403 if missing <code class="language-plaintext highlighter-rouge">fax:read</code> scope. <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -H "X-API-Key: $API_KEY" http://localhost:8080/fax/$JOB_ID
</code></pre></div> </div> </li> </ul> <p>3) GET <code class="language-plaintext highlighter-rouge">/fax/{id}/pdf?token=...</code></p> <ul> <li>Serves the original PDF for cloud provider to fetch.</li> <li>No API auth; requires token that matches stored URL.</li> <li>403 invalid/expired token; 404 not found.</li> </ul> <p>4) POST <code class="language-plaintext highlighter-rouge">/phaxio-callback</code></p> <ul> <li>For Phaxio status webhooks. Expects form-encoded fields (e.g., <code class="language-plaintext highlighter-rouge">fax[status]</code>, <code class="language-plaintext highlighter-rouge">fax[id]</code>).</li> <li>Correlation via query param <code class="language-plaintext highlighter-rouge">?job_id=...</code>.</li> <li>Returns <code class="language-plaintext highlighter-rouge">{ status: "ok" }</code>.</li> <li>Signature verification: if <code class="language-plaintext highlighter-rouge">PHAXIO_VERIFY_SIGNATURE=true</code> (default), the server verifies <code class="language-plaintext highlighter-rouge">X-Phaxio-Signature</code> (HMAC-SHA256 of the raw body using <code class="language-plaintext highlighter-rouge">PHAXIO_API_SECRET</code>). Requests without a valid signature are rejected (401).</li> </ul> <p>5) Admin — API keys</p> <ul> <li> <p>Requires admin auth: either the bootstrap env key (<code class="language-plaintext highlighter-rouge">API_KEY</code>) or a DB key with scope <code class="language-plaintext highlighter-rouge">keys:manage</code>.</p> <p>a) Create a key — <code class="language-plaintext highlighter-rouge">POST /admin/api-keys</code></p> <ul> <li>Body: <code class="language-plaintext highlighter-rouge">{ name?: string, owner?: string, scopes?: string[], expires_at?: ISO8601, note?: string }</code></li> <li>Returns: <code class="language-plaintext highlighter-rouge">{ key_id, token, name?, owner?, scopes[], expires_at? }</code> (token shown ONCE)</li> <li>Example: <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>curl -s -X POST http://localhost:8080/admin/api-keys \
-H "X-API-Key: $API_KEY" -H 'Content-Type: application/json' \
-d '{"name":"svc-bot","owner":"svc@example.com","scopes":["fax:send"]}'
</code></pre></div> </div> </li> </ul> <p>b) List keys — <code class="language-plaintext highlighter-rouge">GET /admin/api-keys</code></p> <ul> <li>Returns: <code class="language-plaintext highlighter-rouge">[{ key_id, name?, owner?, scopes[], created_at, last_used_at?, expires_at?, revoked_at?, note? }]</code></li> </ul> <p>c) Revoke key — <code class="language-plaintext highlighter-rouge">DELETE /admin/api-keys/{keyId}</code></p> <ul> <li>Response: <code class="language-plaintext highlighter-rouge">{ status: "ok" }</code></li> </ul> <p>d) Rotate key — <code class="language-plaintext highlighter-rouge">POST /admin/api-keys/{keyId}/rotate</code></p> <ul> <li>Returns: <code class="language-plaintext highlighter-rouge">{ key_id, token }</code> (new token shown ONCE)</li> </ul> </li> </ul> <p>6) Admin — Config (read-only)</p> <ul> <li><code class="language-plaintext highlighter-rouge">GET /admin/config</code> <ul> <li>Requires admin auth.</li> <li>Returns a sanitized view of effective configuration and runtime flags (no secrets): <ul> <li><code class="language-plaintext highlighter-rouge">backend</code>, <code class="language-plaintext highlighter-rouge">require_api_key</code>, <code class="language-plaintext highlighter-rouge">enforce_public_https</code>, <code class="language-plaintext highlighter-rouge">phaxio_verify_signature</code>, <code class="language-plaintext highlighter-rouge">audit_log_enabled</code></li> <li><code class="language-plaintext highlighter-rouge">rate_limits</code> (global and inbound), <code class="language-plaintext highlighter-rouge">inbound</code> (enabled, retention, token TTL)</li> <li><code class="language-plaintext highlighter-rouge">storage</code> (backend, masked S3 identifiers), <code class="language-plaintext highlighter-rouge">backend_configured</code> booleans, <code class="language-plaintext highlighter-rouge">public_api_url</code></li> </ul> </li> </ul> </li> </ul> <p>7) Inbound (WIP scaffolding; enable with <code class="language-plaintext highlighter-rouge">INBOUND_ENABLED=true</code>)</p> <ul> <li><code class="language-plaintext highlighter-rouge">GET /inbound</code> (requires scope <code class="language-plaintext highlighter-rouge">inbound:list</code>) — list recent inbound faxes.</li> <li><code class="language-plaintext highlighter-rouge">GET /inbound/{id}</code> (requires scope <code class="language-plaintext highlighter-rouge">inbound:read</code>) — get metadata.</li> <li><code class="language-plaintext highlighter-rouge">GET /inbound/{id}/pdf</code> — download inbound PDF via either <code class="language-plaintext highlighter-rouge">?token=...</code> (short‑TTL) or API key with <code class="language-plaintext highlighter-rouge">inbound:read</code>.</li> <li>Internal (SIP/Asterisk): <code class="language-plaintext highlighter-rouge">POST /_internal/asterisk/inbound</code> with header <code class="language-plaintext highlighter-rouge">X-Internal-Secret: &lt;secret&gt;</code> and body <code class="language-plaintext highlighter-rouge">{ tiff_path, to_number, from_number?, faxstatus?, faxpages?, uniqueid }</code>.</li> </ul> <p>Retention and cleanup (inbound)</p> <ul> <li>Set <code class="language-plaintext highlighter-rouge">INBOUND_RETENTION_DAYS</code> to automatically delete stored inbound artifacts after the specified days. The cleanup loop runs every <code class="language-plaintext highlighter-rouge">CLEANUP_INTERVAL_MINUTES</code>.</li> <li>For S3 storage, objects are deleted via the API; for local storage, files are unlinked. Metadata rows remain for audit/history, but <code class="language-plaintext highlighter-rouge">pdf_path</code>/<code class="language-plaintext highlighter-rouge">tiff_path</code> are cleared.</li> <li>When <code class="language-plaintext highlighter-rouge">STORAGE_BACKEND=s3</code>, local PDFs are removed immediately after upload (only the S3 URI is retained).</li> </ul> <h2 id="models"> <a href="#models" class="anchor-heading" aria-labelledby="models"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Models </h2> <ul> <li>FaxJobOut <ul> <li><code class="language-plaintext highlighter-rouge">id: string</code></li> <li><code class="language-plaintext highlighter-rouge">to: string</code></li> <li> <div class="table-wrapper"><table> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">status: string</code> (queued</td> <td>in_progress</td> <td>SUCCESS</td> <td>FAILED</td> <td>disabled)</td> </tr> </tbody> </table></div> </li> <li><code class="language-plaintext highlighter-rouge">error?: string</code></li> <li><code class="language-plaintext highlighter-rouge">pages?: number</code></li> <li><code class="language-plaintext highlighter-rouge">backend: string</code> (“phaxio”, “sinch”, or “sip”)</li> <li><code class="language-plaintext highlighter-rouge">provider_sid?: string</code></li> <li><code class="language-plaintext highlighter-rouge">created_at: ISO8601</code></li> <li><code class="language-plaintext highlighter-rouge">updated_at: ISO8601</code></li> </ul> </li> </ul> <h2 id="notes"> <a href="#notes" class="anchor-heading" aria-labelledby="notes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Notes </h2> <ul> <li>Backend chosen via <code class="language-plaintext highlighter-rouge">FAX_BACKEND</code> env var: <code class="language-plaintext highlighter-rouge">phaxio</code> (cloud via Phaxio/Phaxio‑by‑Sinch V2 style), <code class="language-plaintext highlighter-rouge">sinch</code> (cloud via Sinch Fax API v3 direct upload), or <code class="language-plaintext highlighter-rouge">sip</code> (self‑hosted Asterisk).</li> <li>Default backend is <code class="language-plaintext highlighter-rouge">phaxio</code>. Set <code class="language-plaintext highlighter-rouge">FAX_BACKEND=sip</code> explicitly if you are running Asterisk; set <code class="language-plaintext highlighter-rouge">FAX_BACKEND=sinch</code> for Sinch v3 direct upload.</li> <li>TXT files are converted to PDF before TIFF conversion.</li> <li>If Ghostscript is missing, TIFF step is stubbed with pages=1; install for production.</li> <li>For the <code class="language-plaintext highlighter-rouge">phaxio</code> backend, TIFF conversion is skipped; page count is finalized via the provider callback (<code class="language-plaintext highlighter-rouge">/phaxio-callback</code>, HMAC verification supported).</li> <li>For the <code class="language-plaintext highlighter-rouge">sinch</code> backend, the API uploads your PDF directly to Sinch. Webhook support is under evaluation; status reflects the provider’s immediate response and may be updated by polling in future versions.</li> <li>Tokenized PDF access has a TTL (<code class="language-plaintext highlighter-rouge">PDF_TOKEN_TTL_MINUTES</code>, default 60). The <code class="language-plaintext highlighter-rouge">/fax/{id}/pdf?token=...</code> link expires after TTL.</li> <li>API key tokens are never logged; audits record only the <code class="language-plaintext highlighter-rouge">key_id</code>.</li> <li>Optional retention: enable automatic cleanup of artifacts by setting <code class="language-plaintext highlighter-rouge">ARTIFACT_TTL_DAYS&gt;0</code> (default disabled). Cleanup runs every <code class="language-plaintext highlighter-rouge">CLEANUP_INTERVAL_MINUTES</code> (default 1440).</li> </ul> <h2 id="phone-numbers"> <a href="#phone-numbers" class="anchor-heading" aria-labelledby="phone-numbers"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Phone Numbers </h2> <ul> <li>Preferred format: E.164 (e.g., <code class="language-plaintext highlighter-rouge">+15551234567</code>).</li> <li>Validation: API accepts <code class="language-plaintext highlighter-rouge">+</code> and 6–20 digits.</li> <li>Cloud path (Phaxio): the service may attempt best‑effort normalization for non‑E.164 input; provide E.164 to avoid ambiguity.</li> </ul> <h2 id="audit-logging-optional"> <a href="#audit-logging-optional" class="anchor-heading" aria-labelledby="audit-logging-optional"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Audit Logging (Optional) </h2> <ul> <li>Enable structured audit logs for SIEM ingestion: <ul> <li><code class="language-plaintext highlighter-rouge">AUDIT_LOG_ENABLED=true</code></li> <li><code class="language-plaintext highlighter-rouge">AUDIT_LOG_FORMAT=json</code> (default)</li> <li><code class="language-plaintext highlighter-rouge">AUDIT_LOG_FILE=/var/log/faxbot_audit.log</code> (optional)</li> <li><code class="language-plaintext highlighter-rouge">AUDIT_LOG_SYSLOG=true</code> and <code class="language-plaintext highlighter-rouge">AUDIT_LOG_SYSLOG_ADDRESS=/dev/log</code> (optional)</li> </ul> </li> <li>Events: <code class="language-plaintext highlighter-rouge">job_created</code>, <code class="language-plaintext highlighter-rouge">job_dispatch</code>, <code class="language-plaintext highlighter-rouge">job_updated</code>, <code class="language-plaintext highlighter-rouge">job_failed</code>, <code class="language-plaintext highlighter-rouge">pdf_served</code>.</li> <li>Logs contain job IDs and metadata only (no PHI).</li> </ul> </main> <hr> <footer> <p><a href="#top" id="back-to-top">Back to top</a></p> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2024 Faxbot. Distributed under the <a href="https://github.com/dmontgomery40/Faxbot/blob/main/LICENSE">MIT License</a>.</p> <div class="d-flex mt-2"> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> <script src="https://cdn.jsdelivr.net/npm/mermaid@9.4.0/dist/mermaid.min.js"></script> <script> var config = {} ; mermaid.initialize(config); window.mermaid.init(undefined, document.querySelectorAll('.language-mermaid')); </script> </body> </html>
